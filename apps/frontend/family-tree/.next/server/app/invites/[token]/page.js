(()=>{var e={};e.id=295,e.ids=[295],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27045:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>d}),r(18980),r(63901),r(12523);var i=r(23191),s=r(88716),a=r(37922),n=r.n(a),l=r(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["invites",{children:["[token]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,18980)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/invites/[token]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,63901)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/not-found.tsx"]}],c=["/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/invites/[token]/page.tsx"],u="/invites/[token]/page",m={require:r,loadChunk:()=>Promise.resolve()},f=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/invites/[token]/page",pathname:"/invites/[token]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},27340:(e,t,r)=>{Promise.resolve().then(r.bind(r,12321))},37202:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},12714:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},75290:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},71810:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5932:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},58038:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},24061:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});let i=(0,r(76557).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},92481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return v}});let i=r(91174),s=r(58374),a=r(10326),n=s._(r(17577)),l=i._(r(60962)),o=i._(r(60815)),d=r(23078),c=r(35248),u=r(31206);r(576);let m=r(50131),f=i._(r(86820)),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function h(e,t,r,i,s,a,n){let l=null==e?void 0:e.src;e&&e["data-loaded-src"]!==l&&(e["data-loaded-src"]=l,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&s(!0),null==r?void 0:r.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let i=!1,s=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>i,isPropagationStopped:()=>s,persist:()=>{},preventDefault:()=>{i=!0,t.preventDefault()},stopPropagation:()=>{s=!0,t.stopPropagation()}})}(null==i?void 0:i.current)&&i.current(e)}}))}function g(e){return n.use?{fetchPriority:e}:{fetchpriority:e}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let x=(0,n.forwardRef)((e,t)=>{let{src:r,srcSet:i,sizes:s,height:l,width:o,decoding:d,className:c,style:u,fetchPriority:m,placeholder:f,loading:p,unoptimized:x,fill:y,onLoadRef:v,onLoadingCompleteRef:b,setBlurComplete:j,setShowAltText:w,sizesInput:N,onLoad:k,onError:C,..._}=e;return(0,a.jsx)("img",{..._,...g(m),loading:p,width:o,height:l,decoding:d,"data-nimg":y?"fill":"1",className:c,style:u,sizes:s,srcSet:i,src:r,ref:(0,n.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(C&&(e.src=e.src),e.complete&&h(e,f,v,b,j,x,N))},[r,f,v,b,j,C,x,N,t]),onLoad:e=>{h(e.currentTarget,f,v,b,j,x,N)},onError:e=>{w(!0),"empty"!==f&&j(!0),C&&C(e)}})});function y(e){let{isAppRouter:t,imgAttributes:r}=e,i={as:"image",imageSrcSet:r.srcSet,imageSizes:r.sizes,crossOrigin:r.crossOrigin,referrerPolicy:r.referrerPolicy,...g(r.fetchPriority)};return t&&l.default.preload?(l.default.preload(r.src,i),null):(0,a.jsx)(o.default,{children:(0,a.jsx)("link",{rel:"preload",href:r.srcSet?void 0:r.src,...i},"__nimg-"+r.src+r.srcSet+r.sizes)})}let v=(0,n.forwardRef)((e,t)=>{let r=(0,n.useContext)(m.RouterContext),i=(0,n.useContext)(u.ImageConfigContext),s=(0,n.useMemo)(()=>{var e;let t=p||i||c.imageConfigDefault,r=[...t.deviceSizes,...t.imageSizes].sort((e,t)=>e-t),s=t.deviceSizes.sort((e,t)=>e-t),a=null==(e=t.qualities)?void 0:e.sort((e,t)=>e-t);return{...t,allSizes:r,deviceSizes:s,qualities:a}},[i]),{onLoad:l,onLoadingComplete:o}=e,h=(0,n.useRef)(l);(0,n.useEffect)(()=>{h.current=l},[l]);let g=(0,n.useRef)(o);(0,n.useEffect)(()=>{g.current=o},[o]);let[v,b]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),{props:N,meta:k}=(0,d.getImgProps)(e,{defaultLoader:f.default,imgConf:s,blurComplete:v,showAltText:j});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{...N,unoptimized:k.unoptimized,placeholder:k.placeholder,fill:k.fill,onLoadRef:h,onLoadingCompleteRef:g,setBlurComplete:b,setShowAltText:w,sizesInput:e.sizes,ref:t}),k.priority?(0,a.jsx)(y,{isAppRouter:!r,imgAttributes:N}):null]})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},23484:(e,t,r)=>{"use strict";e.exports=r(81616).vendored.contexts.AmpContext},81157:(e,t,r)=>{"use strict";e.exports=r(81616).vendored.contexts.HeadManagerContext},31206:(e,t,r)=>{"use strict";e.exports=r(81616).vendored.contexts.ImageConfigContext},98710:(e,t)=>{"use strict";function r(e){let{ampFirst:t=!1,hybrid:r=!1,hasQuery:i=!1}=void 0===e?{}:e;return t||r&&i}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return r}})},23078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return l}}),r(576);let i=r(20380),s=r(35248);function a(e){return void 0!==e.default}function n(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function l(e,t){var r,l;let o,d,c,{src:u,sizes:m,unoptimized:f=!1,priority:p=!1,loading:h,className:g,quality:x,width:y,height:v,fill:b=!1,style:j,overrideSrc:w,onLoad:N,onLoadingComplete:k,placeholder:C="empty",blurDataURL:_,fetchPriority:S,decoding:P="async",layout:z,objectFit:M,objectPosition:E,lazyBoundary:I,lazyRoot:O,...A}=e,{imgConf:Z,showAltText:D,blurComplete:R,defaultLoader:T}=t,F=Z||s.imageConfigDefault;if("allSizes"in F)o=F;else{let e=[...F.deviceSizes,...F.imageSizes].sort((e,t)=>e-t),t=F.deviceSizes.sort((e,t)=>e-t),i=null==(r=F.qualities)?void 0:r.sort((e,t)=>e-t);o={...F,allSizes:e,deviceSizes:t,qualities:i}}if(void 0===T)throw Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config");let L=A.loader||T;delete A.loader,delete A.srcSet;let W="__next_img_default"in L;if(W){if("custom"===o.loader)throw Error('Image with src "'+u+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=L;L=t=>{let{config:r,...i}=t;return e(i)}}if(z){"fill"===z&&(b=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[z];e&&(j={...j,...e});let t={responsive:"100vw",fill:"100vw"}[z];t&&!m&&(m=t)}let q="",$=n(y),G=n(v);if("object"==typeof(l=u)&&(a(l)||void 0!==l.src)){let e=a(u)?u.default:u;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(d=e.blurWidth,c=e.blurHeight,_=_||e.blurDataURL,q=e.src,!b){if($||G){if($&&!G){let t=$/e.width;G=Math.round(e.height*t)}else if(!$&&G){let t=G/e.height;$=Math.round(e.width*t)}}else $=e.width,G=e.height}}let V=!p&&("lazy"===h||void 0===h);(!(u="string"==typeof u?u:q)||u.startsWith("data:")||u.startsWith("blob:"))&&(f=!0,V=!1),o.unoptimized&&(f=!0),W&&u.endsWith(".svg")&&!o.dangerouslyAllowSVG&&(f=!0),p&&(S="high");let B=n(x),U=Object.assign(b?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:M,objectPosition:E}:{},D?{}:{color:"transparent"},j),H=R||"empty"===C?null:"blur"===C?'url("data:image/svg+xml;charset=utf-8,'+(0,i.getImageBlurSvg)({widthInt:$,heightInt:G,blurWidth:d,blurHeight:c,blurDataURL:_||"",objectFit:U.objectFit})+'")':'url("'+C+'")',Y=H?{backgroundSize:U.objectFit||"cover",backgroundPosition:U.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:H}:{},J=function(e){let{config:t,src:r,unoptimized:i,width:s,quality:a,sizes:n,loader:l}=e;if(i)return{src:r,srcSet:void 0,sizes:void 0};let{widths:o,kind:d}=function(e,t,r){let{deviceSizes:i,allSizes:s}=e;if(r){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let i;i=e.exec(r);i)t.push(parseInt(i[2]));if(t.length){let e=.01*Math.min(...t);return{widths:s.filter(t=>t>=i[0]*e),kind:"w"}}return{widths:s,kind:"w"}}return"number"!=typeof t?{widths:i,kind:"w"}:{widths:[...new Set([t,2*t].map(e=>s.find(t=>t>=e)||s[s.length-1]))],kind:"x"}}(t,s,n),c=o.length-1;return{sizes:n||"w"!==d?n:"100vw",srcSet:o.map((e,i)=>l({config:t,src:r,quality:a,width:e})+" "+("w"===d?e:i+1)+d).join(", "),src:l({config:t,src:r,quality:a,width:o[c]})}}({config:o,src:u,unoptimized:f,width:$,quality:B,sizes:m,loader:L});return{props:{...A,loading:V?"lazy":h,fetchPriority:S,width:$,height:G,decoding:P,className:g,style:{...U,...Y},sizes:J.sizes,srcSet:J.srcSet,src:w||J.src},meta:{unoptimized:f,priority:p,placeholder:C,fill:b}}}},60815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return h},defaultHead:function(){return u}});let i=r(91174),s=r(58374),a=r(10326),n=s._(r(17577)),l=i._(r(78003)),o=r(23484),d=r(81157),c=r(98710);function u(e){void 0===e&&(e=!1);let t=[(0,a.jsx)("meta",{charSet:"utf-8"})];return e||t.push((0,a.jsx)("meta",{name:"viewport",content:"width=device-width"})),t}function m(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===n.default.Fragment?e.concat(n.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}r(576);let f=["name","httpEquiv","charSet","itemProp"];function p(e,t){let{inAmpMode:r}=t;return e.reduce(m,[]).reverse().concat(u(r).reverse()).filter(function(){let e=new Set,t=new Set,r=new Set,i={};return s=>{let a=!0,n=!1;if(s.key&&"number"!=typeof s.key&&s.key.indexOf("$")>0){n=!0;let t=s.key.slice(s.key.indexOf("$")+1);e.has(t)?a=!1:e.add(t)}switch(s.type){case"title":case"base":t.has(s.type)?a=!1:t.add(s.type);break;case"meta":for(let e=0,t=f.length;e<t;e++){let t=f[e];if(s.props.hasOwnProperty(t)){if("charSet"===t)r.has(t)?a=!1:r.add(t);else{let e=s.props[t],r=i[t]||new Set;("name"!==t||!n)&&r.has(e)?a=!1:(r.add(e),i[t]=r)}}}}return a}}()).reverse().map((e,t)=>{let i=e.key||t;if(!r&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,n.default.cloneElement(e,t)}return n.default.cloneElement(e,{key:i})})}let h=function(e){let{children:t}=e,r=(0,n.useContext)(o.AmpStateContext),i=(0,n.useContext)(d.HeadManagerContext);return(0,a.jsx)(l.default,{reduceComponentsToState:p,headManager:i,inAmpMode:(0,c.isInAmpMode)(r),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},20380:(e,t)=>{"use strict";function r(e){let{widthInt:t,heightInt:r,blurWidth:i,blurHeight:s,blurDataURL:a,objectFit:n}=e,l=i?40*i:t,o=s?40*s:r,d=l&&o?"viewBox='0 0 "+l+" "+o+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+d+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(d?"none":"contain"===n?"xMidYMid":"cover"===n?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+a+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return r}})},35248:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{VALID_LOADERS:function(){return r},imageConfigDefault:function(){return i}});let r=["default","imgix","cloudinary","akamai","custom"],i={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},69029:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return o},getImageProps:function(){return l}});let i=r(91174),s=r(23078),a=r(92481),n=i._(r(86820));function l(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let o=a.Image},86820:(e,t)=>{"use strict";function r(e){var t;let{config:r,src:i,width:s,quality:a}=e,n=a||(null==(t=r.qualities)?void 0:t.reduce((e,t)=>Math.abs(t-75)<Math.abs(e-75)?t:e))||75;return r.path+"?url="+encodeURIComponent(i)+"&w="+s+"&q="+n}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}}),r.__next_img_default=!0;let i=r},78003:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let i=r(17577),s=()=>{},a=()=>{};function n(e){var t;let{headManager:r,reduceComponentsToState:n}=e;function l(){if(r&&r.mountedInstances){let t=i.Children.toArray(Array.from(r.mountedInstances).filter(Boolean));r.updateHead(n(t,e))}}return null==r||null==(t=r.mountedInstances)||t.add(e.children),l(),s(()=>{var t;return null==r||null==(t=r.mountedInstances)||t.add(e.children),()=>{var t;null==r||null==(t=r.mountedInstances)||t.delete(e.children)}}),s(()=>(r&&(r._pendingUpdate=l),()=>{r&&(r._pendingUpdate=l)})),a(()=>(r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null),()=>{r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null)})),null}},12321:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>z});var i=r(10326),s=r(17577),a=r(35047),n=r(29752),l=r(91664),o=r(58038);let d=(0,r(76557).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);var c=r(12714),u=r(75290),m=r(24061),f=r(37202),p=r(71810),h=r(69029),g=r.n(h);let x=({className:e="",size:t=24})=>i.jsx("div",{className:`inline-flex items-center justify-center ${e}`,style:{width:t,height:t},children:i.jsx(g(),{src:"/favicon.svg",alt:"Phylo Logo",width:t,height:t,className:"phylo-logo",priority:!0})});var y=r(5932),v=r(86333),b=r(41190),j=r(44794),w=r(24118),N=r(84097),k=r(32082),C=r(3274);function _({open:e,onOpenChange:t,inviteEmail:r,mode:n="auto"}){let[o,d]=(0,s.useState)(r||""),[c,m]=(0,s.useState)(""),[f,p]=(0,s.useState)("email"),[h,g]=(0,s.useState)(null),[x,_]=(0,s.useState)(!1),[S,P]=(0,s.useState)(!1),{toast:z}=(0,N.pm)(),{setUser:M}=(0,k.a)(),E=(0,a.useRouter)(),I=async e=>{if("auto"===n&&e){P(!0);try{let t=await fetch("http://localhost:8050/api/users/check-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(t.ok){let e=await t.json();g(e.exists?"login":"register")}}catch(e){g("login")}finally{P(!1)}}},O=async e=>{if(e.preventDefault(),!o||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){z({title:"Invalid Email",description:"Please enter a valid email address.",variant:"destructive"});return}if("auto"===n&&!h){await I(o);return}_(!0);try{let e="register"===n||"register"===h;await C.i.requestOTP(o,e),z({title:"Code Sent! \uD83D\uDCE7",description:"Check your email for the verification code."}),p("otp")}catch(e){z({title:"Error",description:e instanceof Error?e.message:"Failed to send code",variant:"destructive"})}finally{_(!1)}},A=async e=>{if(e.preventDefault(),!c||6!==c.length){z({title:"Invalid Code",description:"Please enter the 6-digit code.",variant:"destructive"});return}_(!0);try{let e=await C.i.verifyOTP(o,c);if(e.user){M(e.user);let r="register"===h;z({title:r?"Welcome to Phylo! \uD83C\uDF33":"Welcome back! \uD83D\uDC4B",description:`${r?"Account created and signed in":"Signed in"} as ${e.user.email}`}),t(!1);let i=sessionStorage.getItem("redirectAfterLogin")||"/trees";sessionStorage.removeItem("redirectAfterLogin"),E.push(i)}}catch(e){z({title:"Verification Failed",description:e instanceof Error?e.message:"Invalid or expired code",variant:"destructive"})}finally{_(!1)}},Z=()=>{"otp"===f?(p("email"),m("")):h&&"auto"===n&&g(null)};return i.jsx(w.Vq,{open:e,onOpenChange:()=>{t(!1),setTimeout(()=>{p("email"),d(r||""),m(""),g(null)},200)},children:(0,i.jsxs)(w.cZ,{className:"backdrop-blur-md sm:max-w-[425px]",children:[(0,i.jsxs)(w.fK,{children:[i.jsx(w.$N,{className:"text-2xl",children:"otp"===f?"Enter Code":"login"===n?"Welcome Back":"register"===n?"Create Account":"login"===h?"Welcome Back":"register"===h?"Create Account":"Sign In or Create Account"}),i.jsx(w.Be,{children:"otp"===f?`We sent a verification code to ${o}`:"login"===n?"Sign in to your Phylo account to continue.":"register"===n?"Create your Phylo account to get started.":"login"===h?"Welcome back! Sign in to continue.":"register"===h?"We&apos;ll create your account and send a verification code.":"Enter your email to sign in or create an account."})]}),"email"===f?(0,i.jsxs)("form",{onSubmit:O,className:"space-y-4 pt-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(j._,{htmlFor:"email",children:"Email Address"}),(0,i.jsxs)("div",{className:"relative",children:[i.jsx(y.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),i.jsx(b.I,{id:"email",type:"email",placeholder:"you@example.com",value:o,onChange:e=>d(e.target.value),className:"pl-10",disabled:x||S||!!r,required:!0})]}),r&&i.jsx("p",{className:"text-xs text-muted-foreground",children:"This email is pre-filled from your invitation"})]}),"auto"===n&&h&&i.jsx("div",{className:"p-3 rounded-lg bg-muted",children:i.jsx("p",{className:"text-sm",children:"login"===h?i.jsx(i.Fragment,{children:"âœ“ Account found. We'll send you a sign-in code."}):i.jsx(i.Fragment,{children:"\uD83C\uDD95 New user. We'll create your account and send a verification code."})})}),(0,i.jsxs)("div",{className:"flex gap-2",children:[("login"===h||"register"===h||"otp"===f)&&(0,i.jsxs)(l.z,{type:"button",variant:"outline",onClick:Z,disabled:x||S,className:"w-full",children:[i.jsx(v.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,i.jsxs)(l.z,{type:"submit",className:"w-full",disabled:x||S,children:[(x||S)&&i.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),x?"otp"===f?"Verifying...":S?"Checking...":"Sending Code...":"otp"===f?"Verify & Continue":"login"===n||"login"===h?"Send Sign In Code":"register"===n||"register"===h?"Create Account & Send Code":"auto"!==n||h?"Send Verification Code":"Continue"]})]}),"auto"===n&&!h&&i.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"We'll check if you have an account and guide you accordingly"})]}):(0,i.jsxs)("form",{onSubmit:A,className:"space-y-4 pt-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx(j._,{htmlFor:"otp",children:"Verification Code"}),i.jsx(b.I,{id:"otp",type:"text",placeholder:"000000",value:c,onChange:e=>m(e.target.value.replace(/\D/g,"").slice(0,6)),className:"text-center text-2xl tracking-widest",disabled:x,maxLength:6,required:!0,autoFocus:!0}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the 6-digit code sent to your email"})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(l.z,{type:"button",variant:"outline",onClick:Z,disabled:x,className:"w-full",children:[i.jsx(v.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),i.jsx(l.z,{type:"submit",className:"w-full",disabled:x,children:x?(0,i.jsxs)(i.Fragment,{children:[i.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify & Continue"})]}),i.jsx(l.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{p("email"),m("")},disabled:x,className:"w-full",children:"Resend Code"})]})]})})}let S={custodian:o.Z,contributor:d,viewer:c.Z},P={custodian:"Full access including invites and settings",contributor:"Can add and edit family members",viewer:"Can view the family tree"};function z(){let e=(0,a.useParams)(),t=(0,a.useRouter)(),{user:r,isLoading:o,logout:d}=(0,k.a)(),{toast:c}=(0,N.pm)(),h=e.token,[g,y]=(0,s.useState)(null),[v,b]=(0,s.useState)(!0),[j,w]=(0,s.useState)(!1),[C,z]=(0,s.useState)(null),[M,E]=(0,s.useState)(!1),[I,O]=(0,s.useState)(!1);(0,s.useCallback)(async()=>{try{b(!0);let e=await fetch(`http://localhost:8050/api/invites/${h}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();y(t)}else{let t=await e.json();z(t.detail||"Invitation not found or expired")}}catch{z("Failed to load invitation details")}finally{b(!1)}},[h]);let A=(0,s.useCallback)(async()=>{if(!r){sessionStorage.setItem("redirectAfterLogin",window.location.pathname),E(!0);return}if(r&&g)try{let e=await fetch(`http://localhost:8050/api/trees/${g.tree_id}/members`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok&&(await e.json()).find(e=>e.id===r.id)){c({title:"Already a Member",description:`You&apos;re already a member of ${g.tree_name}. Redirecting to the tree...`}),t.push(`/trees/${g.tree_id}`);return}}catch(e){}if(I){c({title:"Email Mismatch",description:`This invitation is for ${g?.email}, but you&apos;re logged in as ${r.email}. Please sign out and sign in with the correct email.`,variant:"destructive"});return}try{w(!0);let e=await fetch(`http://localhost:8050/api/invites/${h}/accept`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)c({title:"Welcome to the family!",description:`You&apos;ve successfully joined ${g?.tree_name} as a ${g?.role}.`}),t.push(`/trees/${g?.tree_id}`);else{let t=await e.json();c({title:"Failed to accept invitation",description:t.detail||"Please try again.",variant:"destructive"})}}catch(e){c({title:"Error",description:"Failed to accept invitation. Please try again.",variant:"destructive"})}finally{w(!1)}},[r,g,I,h,t,c]);if(v||o)return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900 dark:to-blue-900 flex items-center justify-center p-4",children:i.jsx(n.Zb,{className:"w-full max-w-2xl",children:i.jsx(n.aY,{className:"p-8",children:(0,i.jsxs)("div",{className:"text-center space-y-6",children:[i.jsx("div",{className:"flex justify-center",children:(0,i.jsxs)("div",{className:"relative",children:[i.jsx(x,{className:"h-16 w-16 text-green-600 dark:text-green-400 animate-pulse",size:64}),i.jsx(u.Z,{className:"h-6 w-6 animate-spin text-blue-600 dark:text-blue-400 absolute -top-1 -right-1"})]})}),(0,i.jsxs)("div",{className:"space-y-2",children:[i.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Getting things ready..."}),i.jsx("p",{className:"text-muted-foreground",children:"We're preparing your invitation details"})]}),(0,i.jsxs)("div",{className:"bg-muted rounded-lg p-8 space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-center space-x-2",children:[i.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-bounce"}),i.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),i.jsx("div",{className:"w-3 h-3 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading Phylo features..."})]})]})})})});if(C)return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900 dark:to-orange-900 flex items-center justify-center p-4",children:i.jsx(n.Zb,{className:"w-full max-w-md",children:(0,i.jsxs)(n.aY,{className:"p-8 text-center space-y-4",children:[i.jsx("div",{className:"text-red-500 dark:text-red-400",children:i.jsx(x,{className:"h-16 w-16 mx-auto mb-4",size:64})}),i.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Invitation Issue"}),i.jsx("p",{className:"text-muted-foreground",children:C}),i.jsx(l.z,{onClick:()=>t.push("/"),variant:"outline",children:"Go to Home"})]})})});if(!g)return null;let Z=S[g.role]||m.Z,D=g.member_name||g.email.split("@")[0];return(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900 dark:to-blue-900 flex items-center justify-center p-4",children:[i.jsx(n.Zb,{className:"w-full max-w-2xl",children:i.jsx(n.aY,{className:"p-8",children:(0,i.jsxs)("div",{className:"text-center space-y-6",children:[i.jsx("div",{className:"flex justify-center",children:(0,i.jsxs)("div",{className:"relative",children:[i.jsx(x,{className:"h-16 w-16 text-green-600 dark:text-green-400",size:64}),i.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-600 dark:bg-blue-500 text-white rounded-full p-1",children:i.jsx(Z,{className:"h-4 w-4"})})]})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold text-foreground",children:["Hi, ",D,"!"]}),(0,i.jsxs)("p",{className:"text-lg text-muted-foreground",children:["We are getting your"," ",i.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:g.role})," ","account ready in the"," ",(0,i.jsxs)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:["'",g.tree_name,"'"]})," ","Phylo."]})]}),(0,i.jsxs)("div",{className:"bg-card rounded-lg border p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-foreground",children:g.tree_name}),g.tree_description&&i.jsx("p",{className:"text-sm text-muted-foreground",children:g.tree_description})]}),i.jsx(x,{className:"h-8 w-8 text-green-600 dark:text-green-400",size:32})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[i.jsx(Z,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,i.jsxs)("div",{className:"text-left",children:[i.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100 capitalize",children:g.role}),i.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:P[g.role]})]})]}),g.inviter_name&&(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Invited by"," ",i.jsx("span",{className:"font-medium",children:g.inviter_name})]})]}),I&&(0,i.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-start space-x-3",children:[i.jsx(f.Z,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Email Mismatch"}),(0,i.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:["This invitation is for ",i.jsx("strong",{children:g?.email}),", but you're signed in as ",i.jsx("strong",{children:r?.email}),"."]})]})]}),(0,i.jsxs)(l.z,{onClick:d,variant:"outline",size:"sm",className:"w-full border-yellow-300 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200 hover:bg-yellow-100 dark:hover:bg-yellow-900/40",children:[i.jsx(p.Z,{className:"mr-2 h-4 w-4"}),"Sign Out & Use Correct Email"]})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[r?i.jsx(l.z,{onClick:A,disabled:j||I,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 disabled:opacity-50",size:"lg",children:j?(0,i.jsxs)(i.Fragment,{children:[i.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Joining Phylo..."]}):I?(0,i.jsxs)(i.Fragment,{children:[i.jsx(f.Z,{className:"mr-2 h-4 w-4"}),"Email Mismatch"]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx(x,{className:"mr-2 h-4 w-4",size:16}),"Accept & Join Phylo"]})}):(0,i.jsxs)(l.z,{onClick:()=>{sessionStorage.setItem("redirectAfterLogin",window.location.pathname),E(!0)},className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",size:"lg",children:[i.jsx(x,{className:"mr-2 h-4 w-4",size:16}),"Sign In to Accept"]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"By accepting, you agree to join this Phylo and collaborate with other members."})]}),(0,i.jsxs)("div",{className:"bg-muted rounded-lg p-6 space-y-4",children:[i.jsx("h4",{className:"font-medium text-foreground",children:"What you'll get access to:"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),i.jsx("span",{children:"Interactive family tree"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),i.jsx("span",{children:"Member profiles & photos"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"1s"}}),i.jsx("span",{children:"Relationship tracking"})]})]})]})]})})}),i.jsx(_,{open:M,onOpenChange:E,inviteEmail:g?.email,mode:"auto"})]})}},29752:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>l,SZ:()=>d,Zb:()=>n,aY:()=>c,eW:()=>u,ll:()=>o});var i=r(10326),s=r(17577),a=r(51223);let n=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let l=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let u=s.forwardRef(({className:e,...t},r)=>i.jsx("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},41190:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var i=r(10326),s=r(17577),a=r(51223);let n=s.forwardRef(({className:e,type:t,...r},s)=>i.jsx("input",{type:t,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));n.displayName="Input"},44794:(e,t,r)=>{"use strict";r.d(t,{_:()=>d});var i=r(10326),s=r(17577),a=r(34478),n=r(79360),l=r(51223);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef(({className:e,...t},r)=>i.jsx(a.f,{ref:r,className:(0,l.cn)(o(),e),...t}));d.displayName=a.f.displayName},18980:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(68570).createProxy)(String.raw`/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/invites/[token]/page.tsx#default`)},34478:(e,t,r)=>{"use strict";r.d(t,{f:()=>l});var i=r(17577),s=r(45226),a=r(10326),n=i.forwardRef((e,t)=>(0,a.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var l=n}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[990,752],()=>r(27045));module.exports=i})();