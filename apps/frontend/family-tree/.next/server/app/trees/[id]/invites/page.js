(()=>{var e={};e.id=342,e.ids=[342],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},31102:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c}),i(87058),i(63901),i(12523);var s=i(23191),r=i(88716),n=i(37922),a=i.n(n),l=i(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);i.d(t,o);let c=["",{children:["trees",{children:["[id]",{children:["invites",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,87058)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/trees/[id]/invites/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(i.bind(i,63901)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.bind(i,12523)),"/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/not-found.tsx"]}],d=["/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/trees/[id]/invites/page.tsx"],m="/trees/[id]/invites/page",p={require:i,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/trees/[id]/invites/page",pathname:"/trees/[id]/invites",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4885:(e,t,i)=>{Promise.resolve().then(i.bind(i,57213))},24061:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});let s=(0,i(76557).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},57213:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>f});var s=i(10326),r=i(17577),n=i(35047),a=i(91664),l=i(29752),o=i(28180),c=i(683),d=i(84097),m=i(98023),p=i(75290),h=i(86333),x=i(83855),u=i(5932),v=i(24061);function f(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),{toast:i}=(0,d.pm)(),[f,j]=(0,r.useState)(null),[y,g]=(0,r.useState)([]),[w,k]=(0,r.useState)(!0),[N,b]=(0,r.useState)(!1),P=e.id,{members:_}=(0,m.r)({treeId:P,autoFetch:!0}),E=async()=>{try{k(!0);let e=await fetch(`http://localhost:8050/api/trees/${P}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch tree");let t=await e.json();j(t);let i=await fetch(`http://localhost:8050/api/trees/${P}/invites`,{credentials:"include"});if(i.ok){let e=await i.json();g(e)}}catch(e){console.error("Error fetching data:",e),i({title:"Error",description:"Failed to load invites. Please try again.",variant:"destructive"})}finally{k(!1)}},C=async e=>{try{if((await fetch(`http://localhost:8050/api/invites/${e}/resend`,{method:"POST",credentials:"include"})).ok)i({title:"Invite Resent",description:"The invitation has been resent successfully."}),E();else throw Error("Failed to resend invite")}catch(e){console.error("Error resending invite:",e),i({title:"Error",description:"Failed to resend invite. Please try again.",variant:"destructive"})}},S=async e=>{try{if((await fetch(`http://localhost:8050/api/invites/${e}`,{method:"DELETE",credentials:"include"})).ok)i({title:"Invite Cancelled",description:"The invitation has been cancelled."}),E();else throw Error("Failed to cancel invite")}catch(e){console.error("Error cancelling invite:",e),i({title:"Error",description:"Failed to cancel invite. Please try again.",variant:"destructive"})}};if(w)return s.jsx(o.c,{children:s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(p.Z,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading invites..."})]})})});if(!f)return null;let I="custodian"===f.role;return(0,s.jsxs)(o.c,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(a.z,{variant:"ghost",onClick:()=>t.back(),children:[s.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Invitations"}),s.jsx("p",{className:"text-muted-foreground",children:f.name})]})]}),I&&s.jsx("div",{className:"flex justify-end",children:(0,s.jsxs)(a.z,{onClick:()=>b(!0),children:[s.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Send Invite"]})}),(0,s.jsxs)(l.Zb,{children:[s.jsx(l.Ol,{children:(0,s.jsxs)(l.ll,{className:"flex items-center gap-2",children:[s.jsx(u.Z,{className:"h-5 w-5"}),"Pending Invitations"]})}),s.jsx(l.aY,{children:0===y.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[s.jsx(v.Z,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Invitations"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:I?"You haven't sent any invitations yet.":"There are no pending invitations for this tree."}),I&&(0,s.jsxs)(a.z,{onClick:()=>b(!0),children:[s.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Send First Invite"]})]}):s.jsx("div",{className:"space-y-4",children:y.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium",children:e.email}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Role: ",e.role," â€¢ Expires:"," ",new Date(e.expires_at).toLocaleDateString()]})]}),I&&(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(a.z,{variant:"outline",size:"sm",onClick:()=>C(e.token),children:"Resend"}),s.jsx(a.z,{variant:"outline",size:"sm",onClick:()=>S(e.token),children:"Cancel"})]})]},e.id))})})]})]}),s.jsx(c.y,{open:N,onOpenChange:b,treeId:P,members:_,onInviteSent:()=>{E(),b(!1)}})]})}},87058:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});let s=(0,i(68570).createProxy)(String.raw`/mnt/win3/work/family_tree/apps/frontend/family-tree/src/app/trees/[id]/invites/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),s=t.X(0,[990,153,882,752,711,204],()=>i(31102));module.exports=s})();