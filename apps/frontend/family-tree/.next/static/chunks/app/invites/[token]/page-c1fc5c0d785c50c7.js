(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7295],{51151:function(e,t,a){Promise.resolve().then(a.bind(a,87640))},87640:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var s=a(57437),n=a(2265),i=a(99376),r=a(79820),l=a(12381),o=a(88906),c=a(15868),d=a(42208),u=a(15863),m=a(95805),f=a(63639),h=a(47692),x=a(33145);let g=e=>{let{className:t="",size:a=24}=e;return(0,s.jsx)("div",{className:"inline-flex items-center justify-center ".concat(t),style:{width:a,height:a},children:(0,s.jsx)(x.default,{src:"/favicon.svg",alt:"Phylo Logo",width:a,height:a,className:"phylo-logo",priority:!0})})};var p=a(89345),y=a(32660),v=a(40279),j=a(75060),b=a(74291),N=a(23340),w=a(50828),k=a(65754);function S(e){let{open:t,onOpenChange:a,inviteEmail:r,mode:o="auto"}=e,[c,d]=(0,n.useState)(r||""),[m,f]=(0,n.useState)(""),[h,x]=(0,n.useState)("email"),[g,S]=(0,n.useState)(null),[C,T]=(0,n.useState)(!1),[A,_]=(0,n.useState)(!1),{toast:E}=(0,N.pm)(),{setUser:D}=(0,w.a)(),O=(0,i.useRouter)();(0,n.useEffect)(()=>{r&&d(r)},[r]);let z=async e=>{if("auto"===o&&e){_(!0);try{let t=await fetch("".concat("http://localhost:8050/api","/users/check-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(t.ok){let e=await t.json();S(e.exists?"login":"register")}}catch(e){S("login")}finally{_(!1)}}},I=async e=>{if(e.preventDefault(),!c||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)){E({title:"Invalid Email",description:"Please enter a valid email address.",variant:"destructive"});return}if("auto"===o&&!g){await z(c);return}T(!0);try{let e="register"===o||"register"===g;await k.i.requestOTP(c,e),E({title:"Code Sent! \uD83D\uDCE7",description:"Check your email for the verification code."}),x("otp")}catch(e){E({title:"Error",description:e instanceof Error?e.message:"Failed to send code",variant:"destructive"})}finally{T(!1)}},P=async e=>{if(e.preventDefault(),!m||6!==m.length){E({title:"Invalid Code",description:"Please enter the 6-digit code.",variant:"destructive"});return}T(!0);try{let e=await k.i.verifyOTP(c,m);if(e.user){D(e.user);let t="register"===g;E({title:t?"Welcome to Phylo! \uD83C\uDF33":"Welcome back! \uD83D\uDC4B",description:"".concat(t?"Account created and signed in":"Signed in"," as ").concat(e.user.email)}),a(!1);let s=sessionStorage.getItem("redirectAfterLogin")||"/trees";sessionStorage.removeItem("redirectAfterLogin"),O.push(s)}}catch(e){E({title:"Verification Failed",description:e instanceof Error?e.message:"Invalid or expired code",variant:"destructive"})}finally{T(!1)}},Z=()=>{"otp"===h?(x("email"),f("")):g&&"auto"===o&&S(null)};return(0,s.jsx)(b.Vq,{open:t,onOpenChange:()=>{a(!1),setTimeout(()=>{x("email"),d(r||""),f(""),S(null)},200)},children:(0,s.jsxs)(b.cZ,{className:"backdrop-blur-md sm:max-w-[425px]",children:[(0,s.jsxs)(b.fK,{children:[(0,s.jsx)(b.$N,{className:"text-2xl",children:"otp"===h?"Enter Code":"login"===o?"Welcome Back":"register"===o?"Create Account":"login"===g?"Welcome Back":"register"===g?"Create Account":"Sign In or Create Account"}),(0,s.jsx)(b.Be,{children:"otp"===h?"We sent a verification code to ".concat(c):"login"===o?"Sign in to your Phylo account to continue.":"register"===o?"Create your Phylo account to get started.":"login"===g?"Welcome back! Sign in to continue.":"register"===g?"We&apos;ll create your account and send a verification code.":"Enter your email to sign in or create an account."})]}),"email"===h?(0,s.jsxs)("form",{onSubmit:I,className:"space-y-4 pt-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j._,{htmlFor:"email",children:"Email Address"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(p.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(v.I,{id:"email",type:"email",placeholder:"you@example.com",value:c,onChange:e=>d(e.target.value),className:"pl-10",disabled:C||A||!!r,required:!0})]}),r&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"This email is pre-filled from your invitation"})]}),"auto"===o&&g&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-muted",children:(0,s.jsx)("p",{className:"text-sm",children:"login"===g?(0,s.jsx)(s.Fragment,{children:"âœ“ Account found. We'll send you a sign-in code."}):(0,s.jsx)(s.Fragment,{children:"\uD83C\uDD95 New user. We'll create your account and send a verification code."})})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[("login"===g||"register"===g||"otp"===h)&&(0,s.jsxs)(l.z,{type:"button",variant:"outline",onClick:Z,disabled:C||A,className:"w-full",children:[(0,s.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,s.jsxs)(l.z,{type:"submit",className:"w-full",disabled:C||A,children:[(C||A)&&(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),C?"otp"===h?"Verifying...":A?"Checking...":"Sending Code...":"otp"===h?"Verify & Continue":"login"===o||"login"===g?"Send Sign In Code":"register"===o||"register"===g?"Create Account & Send Code":"auto"!==o||g?"Send Verification Code":"Continue"]})]}),"auto"===o&&!g&&(0,s.jsx)("p",{className:"text-center text-sm text-muted-foreground",children:"We'll check if you have an account and guide you accordingly"})]}):(0,s.jsxs)("form",{onSubmit:P,className:"space-y-4 pt-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j._,{htmlFor:"otp",children:"Verification Code"}),(0,s.jsx)(v.I,{id:"otp",type:"text",placeholder:"000000",value:m,onChange:e=>f(e.target.value.replace(/\D/g,"").slice(0,6)),className:"text-center text-2xl tracking-widest",disabled:C,maxLength:6,required:!0,autoFocus:!0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter the 6-digit code sent to your email"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.z,{type:"button",variant:"outline",onClick:Z,disabled:C,className:"w-full",children:[(0,s.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,s.jsx)(l.z,{type:"submit",className:"w-full",disabled:C,children:C?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify & Continue"})]}),(0,s.jsx)(l.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>{x("email"),f("")},disabled:C,className:"w-full",children:"Resend Code"})]})]})})}let C={custodian:o.Z,contributor:c.Z,viewer:d.Z},T={custodian:"Full access including invites and settings",contributor:"Can add and edit family members",viewer:"Can view the family tree"};function A(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{user:a,isLoading:o,logout:c}=(0,w.a)(),{toast:d}=(0,N.pm)(),x=e.token,[p,y]=(0,n.useState)(null),[v,j]=(0,n.useState)(!0),[b,k]=(0,n.useState)(!1),[A,_]=(0,n.useState)(null),[E,D]=(0,n.useState)(!1),[O,z]=(0,n.useState)(!1),I=(0,n.useCallback)(async()=>{try{j(!0);let e=await fetch("".concat("http://localhost:8050/api","/invites/").concat(x),{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();y(t)}else{let t=await e.json();_(t.detail||"Invitation not found or expired")}}catch(e){_("Failed to load invitation details")}finally{j(!1)}},[x]);(0,n.useEffect)(()=>{x&&I()},[x,I]),(0,n.useEffect)(()=>{a&&p?z(a.email.toLowerCase()!==p.email.toLowerCase()):z(!1)},[a,p]);let P=(0,n.useCallback)(async()=>{if(!a){sessionStorage.setItem("redirectAfterLogin",window.location.pathname),D(!0);return}if(a&&p)try{let e=await fetch("".concat("http://localhost:8050/api","/trees/").concat(p.tree_id,"/members"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok&&(await e.json()).find(e=>e.id===a.id)){d({title:"Already a Member",description:"You&apos;re already a member of ".concat(p.tree_name,". Redirecting to the tree...")}),t.push("/trees/".concat(p.tree_id));return}}catch(e){}if(O){d({title:"Email Mismatch",description:"This invitation is for ".concat(null==p?void 0:p.email,", but you&apos;re logged in as ").concat(a.email,". Please sign out and sign in with the correct email."),variant:"destructive"});return}try{k(!0);let e=await fetch("".concat("http://localhost:8050/api","/invites/").concat(x,"/accept"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)d({title:"Welcome to the family!",description:"You&apos;ve successfully joined ".concat(null==p?void 0:p.tree_name," as a ").concat(null==p?void 0:p.role,".")}),t.push("/trees/".concat(null==p?void 0:p.tree_id));else{let t=await e.json();d({title:"Failed to accept invitation",description:t.detail||"Please try again.",variant:"destructive"})}}catch(e){d({title:"Error",description:"Failed to accept invitation. Please try again.",variant:"destructive"})}finally{k(!1)}},[a,p,O,x,t,d]);if(v||o)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900 dark:to-blue-900 flex items-center justify-center p-4",children:(0,s.jsx)(r.Zb,{className:"w-full max-w-2xl",children:(0,s.jsx)(r.aY,{className:"p-8",children:(0,s.jsxs)("div",{className:"text-center space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g,{className:"h-16 w-16 text-green-600 dark:text-green-400 animate-pulse",size:64}),(0,s.jsx)(u.Z,{className:"h-6 w-6 animate-spin text-blue-600 dark:text-blue-400 absolute -top-1 -right-1"})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Getting things ready..."}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"We're preparing your invitation details"})]}),(0,s.jsxs)("div",{className:"bg-muted rounded-lg p-8 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-3 h-3 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-3 h-3 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading Phylo features..."})]})]})})})});if(A)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900 dark:to-orange-900 flex items-center justify-center p-4",children:(0,s.jsx)(r.Zb,{className:"w-full max-w-md",children:(0,s.jsxs)(r.aY,{className:"p-8 text-center space-y-4",children:[(0,s.jsx)("div",{className:"text-red-500 dark:text-red-400",children:(0,s.jsx)(g,{className:"h-16 w-16 mx-auto mb-4",size:64})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Invitation Issue"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:A}),(0,s.jsx)(l.z,{onClick:()=>t.push("/"),variant:"outline",children:"Go to Home"})]})})});if(!p)return null;let Z=C[p.role]||m.Z,R=p.member_name||p.email.split("@")[0];return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900 dark:to-blue-900 flex items-center justify-center p-4",children:[(0,s.jsx)(r.Zb,{className:"w-full max-w-2xl",children:(0,s.jsx)(r.aY,{className:"p-8",children:(0,s.jsxs)("div",{className:"text-center space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g,{className:"h-16 w-16 text-green-600 dark:text-green-400",size:64}),(0,s.jsx)("div",{className:"absolute -top-2 -right-2 bg-blue-600 dark:bg-blue-500 text-white rounded-full p-1",children:(0,s.jsx)(Z,{className:"h-4 w-4"})})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-foreground",children:["Hi, ",R,"!"]}),(0,s.jsxs)("p",{className:"text-lg text-muted-foreground",children:["We are getting your"," ",(0,s.jsx)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:p.role})," ","account ready in the"," ",(0,s.jsxs)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:["'",p.tree_name,"'"]})," ","Phylo."]})]}),(0,s.jsxs)("div",{className:"bg-card rounded-lg border p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("h3",{className:"font-semibold text-foreground",children:p.tree_name}),p.tree_description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:p.tree_description})]}),(0,s.jsx)(g,{className:"h-8 w-8 text-green-600 dark:text-green-400",size:32})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsx)(Z,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100 capitalize",children:p.role}),(0,s.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:T[p.role]})]})]}),p.inviter_name&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Invited by"," ",(0,s.jsx)("span",{className:"font-medium",children:p.inviter_name})]})]}),O&&(0,s.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)(f.Z,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Email Mismatch"}),(0,s.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:["This invitation is for ",(0,s.jsx)("strong",{children:null==p?void 0:p.email}),", but you're signed in as ",(0,s.jsx)("strong",{children:null==a?void 0:a.email}),"."]})]})]}),(0,s.jsxs)(l.z,{onClick:c,variant:"outline",size:"sm",className:"w-full border-yellow-300 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200 hover:bg-yellow-100 dark:hover:bg-yellow-900/40",children:[(0,s.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Sign Out & Use Correct Email"]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[a?(0,s.jsx)(l.z,{onClick:P,disabled:b||O,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 disabled:opacity-50",size:"lg",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Joining Phylo..."]}):O?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Email Mismatch"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g,{className:"mr-2 h-4 w-4",size:16}),"Accept & Join Phylo"]})}):(0,s.jsxs)(l.z,{onClick:()=>{sessionStorage.setItem("redirectAfterLogin",window.location.pathname),D(!0)},className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",size:"lg",children:[(0,s.jsx)(g,{className:"mr-2 h-4 w-4",size:16}),"Sign In to Accept"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"By accepting, you agree to join this Phylo and collaborate with other members."})]}),(0,s.jsxs)("div",{className:"bg-muted rounded-lg p-6 space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-foreground",children:"What you'll get access to:"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,s.jsx)("span",{children:"Interactive family tree"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),(0,s.jsx)("span",{children:"Member profiles & photos"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"1s"}}),(0,s.jsx)("span",{children:"Relationship tracking"})]})]})]})]})})}),(0,s.jsx)(S,{open:E,onOpenChange:D,inviteEmail:null==p?void 0:p.email,mode:"auto"})]})}},12381:function(e,t,a){"use strict";a.d(t,{d:function(){return o},z:function(){return c}});var s=a(57437),n=a(2265),i=a(37053),r=a(90535),l=a(93448);let o=(0,r.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:a,variant:n,size:r,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:n,size:r,className:a})),ref:t,...d})});c.displayName="Button"},79820:function(e,t,a){"use strict";a.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return r},aY:function(){return d},eW:function(){return u},ll:function(){return o}});var s=a(57437),n=a(2265),i=a(93448);let r=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});r.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...n})});l.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});o.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...n})});u.displayName="CardFooter"},74291:function(e,t,a){"use strict";a.d(t,{$N:function(){return x},Be:function(){return g},Vq:function(){return o},cN:function(){return h},cZ:function(){return m},fK:function(){return f},hg:function(){return c}});var s=a(57437),n=a(2265),i=a(49027),r=a(32489),l=a(93448);let o=i.fC,c=i.xz,d=i.h_;i.x8;let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});u.displayName=i.aV.displayName;let m=n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[n,(0,s.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=i.VY.displayName;let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});x.displayName=i.Dx.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...n})});g.displayName=i.dk.displayName},40279:function(e,t,a){"use strict";a.d(t,{I:function(){return r}});var s=a(57437),n=a(2265),i=a(93448);let r=n.forwardRef((e,t)=>{let{className:a,type:n,...r}=e;return(0,s.jsx)("input",{type:n,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});r.displayName="Input"},75060:function(e,t,a){"use strict";a.d(t,{_:function(){return c}});var s=a(57437),n=a(2265),i=a(6394),r=a(90535),l=a(93448);let o=(0,r.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.f,{ref:t,className:(0,l.cn)(o(),a),...n})});c.displayName=i.f.displayName},50828:function(e,t,a){"use strict";a.d(t,{a:function(){return l}});var s=a(3011),n=a(89134),i=a(65754);let r=(0,s.U)()((0,n.tJ)(e=>({user:null,isLoading:!0,isAuthenticated:!1,setUser:t=>e({user:t,isAuthenticated:!!t,isLoading:!1}),setLoading:t=>e({isLoading:t}),checkAuth:async()=>{e({isLoading:!0}),console.log("[useAuth] Starting auth check...");try{let t=await i.i.getCurrentUser();console.log("[useAuth] Auth check result:",t?"User: ".concat(t.email):"No user (not authenticated)"),e({user:t,isAuthenticated:!!t,isLoading:!1})}catch(t){console.error("[useAuth] Auth check error:",t),e({user:null,isAuthenticated:!1,isLoading:!1})}},logout:async()=>{try{await i.i.logout(),e({user:null,isAuthenticated:!1,isLoading:!1})}catch(t){console.error("Logout failed:",t),e({user:null,isAuthenticated:!1,isLoading:!1})}}}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})}));function l(){let{user:e,isLoading:t,isAuthenticated:a,setUser:s,checkAuth:n,logout:i}=r();return{user:e,isLoading:t,isAuthenticated:a,setUser:s,checkAuth:n,logout:i}}},23340:function(e,t,a){"use strict";a.d(t,{pm:function(){return m}});var s=a(2265);let n=0,i=new Map,r=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},65754:function(e,t,a){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers},credentials:"include"});if(!a.ok)throw Error((await a.json().catch(()=>({detail:"An error occurred"}))).detail||"HTTP ".concat(a.status));return a.json()}a.d(t,{i:function(){return n}});let n={async requestOTP(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s("/api/auth/otp/request",{method:"POST",body:JSON.stringify({email:e,is_registration:t})})},verifyOTP:async(e,t,a)=>s("/api/auth/otp/verify",{method:"POST",body:JSON.stringify({email:e,code:t,display_name:a})}),async getCurrentUser(){try{return await s("/api/auth/me",{method:"GET"})}catch(e){return null}},async logout(){await s("/api/auth/logout",{method:"POST"})},refreshToken:async()=>s("/api/auth/refresh",{method:"POST"})}},93448:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var s=a(61994),n=a(53335);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,s.W)(t))}}},function(e){e.O(0,[7697,1770,4041,2971,2117,1744],function(){return e(e.s=51151)}),_N_E=e.O()}]);